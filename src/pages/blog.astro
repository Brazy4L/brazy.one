---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

// Use Astro.glob() to fetch all posts, and then sort them by date.
const posts = (await Astro.glob('./blog/*.{md,mdx}')).sort(
  (a, b) =>
    new Date(b.frontmatter.pubDate).valueOf() -
    new Date(a.frontmatter.pubDate).valueOf()
);
---

<!DOCTYPE html>
<html lang="en">
  <head>
    <BaseHead
      title="Brazy | Blog"
      description="My thoughts about tech and everything else."
    />
  </head>
  <body class="min-h-screen flex flex-col max-w-[700px] mx-auto px-2">
    <Header />
    <main>
      <section class="mb-20">
        <ul class="grid gap-20">
          {
            posts.map((post) => (
              <li>
                <a href={post.url + `/`}>
                  <img
                    class="rounded-md"
                    width="884"
                    height="370"
                    src={post.frontmatter.heroImage}
                    alt={post.frontmatter.title}
                  />
                  <h1 class="w-max text-3xl font-bold text-gray-200 hover:text-[#a786ff] ease-out duration-300 mt-4">
                    {post.frontmatter.title}
                  </h1>
                </a>
                <p class="text-gray-400">
                  <time>{post.frontmatter.pubDate}</time>
                  {post.frontmatter.updatedDate && (
                    <span>
                      (Updated:
                      <time>{post.frontmatter.updatedDate}</time>)
                    </span>
                  )}
                </p>
              </li>
            ))
          }
        </ul>
      </section>
    </main>
    <Footer />
  </body>
</html>
